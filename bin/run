#!/usr/bin/env ruby

require 'erb'

include ERB::Util

root_path = File.expand_path('..', __dir__)
require File.join(root_path, 'lib', 'jobs_repository')
require File.join(root_path, 'lib', 'helpers', 'debug_helper')

include DebugHelper

feed_template = File.read(File.join(root_path, 'lib', 'templates', 'feed.erb'))
debug_template = File.read(File.join(root_path, 'lib', 'templates', 'debug.erb'))

@jobs = JobsRepository.fetch_jobs

File.write("#{ARGV[0]}/feed.xml", ERB.new(feed_template, nil, '-').result(binding))
File.write("#{ARGV[0]}/debug.html", ERB.new(debug_template, nil, '-').result(binding))
